      function premgesmallq(modetype,omega)
      common /plevel/iprtlv
      logical splined
      dimension tcube(3,641)
      dimension scube(3,691)
      dimension work(3,1000)
c     there are 641 toroidal modes to spline
c     there are 691 spheroidal modes to spline
      dimension tomega( 641)
      dimension tpvel( 641)
      dimension somega( 691)
      dimension spvel( 691)
      save
      data ntspl,nsspl / 641, 691/
      data splined/.false./
c
      data tomega /
     # 0.00238238,0.00368296,0.00481078,0.00583232,0.00677851,0.00766991,
     # 0.00852072,0.00934066,0.01013646,0.01091296,0.01167379,0.01242180,
     # 0.01315925,0.01388803,0.01460963,0.01532531,0.01603612,0.01674291,
     # 0.01744640,0.01814716,0.01884570,0.01954241,0.02023762,0.02093162,
     # 0.02162463,0.02231681,0.02300836,0.02369938,0.02438999,0.02508028,
     # 0.02577032,0.02646016,0.02714987,0.02783948,0.02852901,0.02921851,
     # 0.02990798,0.03059744,0.03128691,0.03197641,0.03266592,0.03335546,
     # 0.03404504,0.03473467,0.03542432,0.03611401,0.03680375,0.03749353,
     # 0.03818334,0.03887319,0.03956307,0.04025297,0.04094291,0.04163286,
     # 0.04232284,0.04301283,0.04370283,0.04439285,0.04508287,0.04577290,
     # 0.04646293,0.04715297,0.04784299,0.04853301,0.04922302,0.04991302,
     # 0.05060300,0.05129296,0.05198290,0.05267281,0.05336270,0.05405255,
     # 0.05474238,0.05543216,0.05612191,0.05681162,0.05750129,0.05819090,
     # 0.05888048,0.05957000,0.06025946,0.06094887,0.06163823,0.06232752,
     # 0.06301675,0.06370591,0.06439502,0.06508405,0.06577300,0.06646188,
     # 0.06715070,0.06783942,0.06852807,0.06921664,0.06990512,0.07059351,
     # 0.07128182,0.07197004,0.07265816,0.07334618,0.07403411,0.07472194,
     # 0.07540967,0.07609729,0.07678481,0.07747222,0.07815952,0.07884671,
     # 0.07953378,0.08022073,0.08090757,0.08159429,0.08228088,0.08296735,
     # 0.08365369,0.08433990,0.08502598,0.08571193,0.08639774,0.08708341,
     # 0.08776895,0.08845434,0.08913958,0.08982468,0.09050963,0.09119444,
     # 0.09187908,0.09256357,0.09324790,0.09393207,0.09461608,0.09529992,
     # 0.09598360,0.09666710,0.09735043,0.09803360,0.09871657,0.09939939,
     # 0.10008200,0.10076445,0.10144669,0.10212876,0.10281062,0.10349231,
     # 0.10417378,0.10485508,0.10553615,0.10621703,0.10689768,0.10757814,
     # 0.10825840,0.10893843,0.10961825,0.11029785,0.11097722,0.11165637,
     # 0.11233529,0.11301398,0.11369244,0.11437066,0.11504863,0.11572637,
     # 0.11640386,0.11708110,0.11775810,0.11843483,0.11911132,0.11978755,
     # 0.12046353,0.12113923,0.12181467,0.12248984,0.12316474,0.12383936,
     # 0.12451369,0.12518775,0.12586153,0.12653501,0.12720822,0.12788111,
     # 0.12855372,0.12922603,0.12989803,0.13056971,0.13124110,0.13191219,
     # 0.13258293,0.13325338,0.13392350,0.13459329,0.13526276,0.13593189,
     # 0.13660070,0.13726917,0.13793729,0.13860507,0.13927251,0.13993959,
     # 0.14060633,0.14127271,0.14193873,0.14260440,0.14326969,0.14393461,
     # 0.14459917,0.14526334,0.14592715,0.14659058,0.14725360,0.14791626,
     # 0.14857852,0.14924039,0.14990187,0.15056294,0.15122361,0.15188389,
     # 0.15254375,0.15320320,0.15386224,0.15452085,0.15517907,0.15583684,
     # 0.15649420,0.15715112,0.15780762,0.15846367,0.15911929,0.15977448,
     # 0.16042922,0.16108352,0.16173738,0.16239077,0.16304372,0.16369621,
     # 0.16434824,0.16499981,0.16565092,0.16630156,0.16695175,0.16760144,
     # 0.16825068,0.16889943,0.16954771,0.17019551,0.17084281,0.17148964,
     # 0.17213598,0.17278183,0.17342719,0.17407206,0.17471643,0.17536029,
     # 0.17600366,0.17664653,0.17728890,0.17793076,0.17857212,0.17921296,
     # 0.17985329,0.18049312,0.18113242,0.18177120,0.18240948,0.18304722,
     # 0.18368445,0.18432117,0.18495734,0.18559301,0.18622814,0.18686274,
     # 0.18749681,0.18813036,0.18876338,0.18939586,0.19002780,0.19065921,
     # 0.19129008,0.19192041,0.19255023,0.19317949,0.19380820,0.19443639,
     # 0.19506402,0.19569112,0.19631767,0.19694369,0.19756915,0.19819407,
     # 0.19881846,0.19944228,0.20006557,0.20068832,0.20131050,0.20193215,
     # 0.20255326,0.20317380,0.20379381,0.20441326,0.20503217,0.20565054,
     # 0.20626834,0.20688561,0.20750232,0.20811850,0.20873411,0.20934919,
     # 0.20996371,0.21057770,0.21119112,0.21180400,0.21241634,0.21302813,
     # 0.21363938,0.21425007,0.21486023,0.21546984,0.21607891,0.21668743,
     # 0.21729541,0.21790284,0.21850973,0.21911608,0.21972190,0.22032717,
     # 0.22093190,0.22153610,0.22213975,0.22274287,0.22334546,0.22394751,
     # 0.22454903,0.22515000,0.22575045,0.22635037,0.22694975,0.22754861,
     # 0.22814694,0.22874475,0.22934201,0.22993876,0.23053499,0.23113069,
     # 0.23172587,0.23232053,0.23291467,0.23350829,0.23410138,0.23469397,
     # 0.23528604,0.23587760,0.23646864,0.23705918,0.23764920,0.23823872,
     # 0.23882772,0.23941623,0.24000423,0.24059172,0.24117871,0.24176520,
     # 0.24235119,0.24293669,0.24352169,0.24410619,0.24469021,0.24527372,
     # 0.24585675,0.24643929,0.24702133,0.24760288,0.24818397,0.24876456,
     # 0.24934468,0.24992432,0.25050348,0.25108215,0.25166038,0.25223809,
     # 0.25281537,0.25339216,0.25396848,0.25454432,0.25511971,0.25569463,
     # 0.25626910,0.25684309,0.25741664,0.25798970,0.25856236,0.25913450,
     # 0.25970623,0.26027751,0.26084831,0.26141870,0.26198861,0.26255810,
     # 0.26312715,0.26369572,0.26426390,0.26483160,0.26539889,0.26596573,
     # 0.26653215,0.26709813,0.26766369,0.26822880,0.26879352,0.26935777,
     # 0.26992163,0.27048507,0.27104807,0.27161068,0.27217284,0.27273461,
     # 0.27329597,0.27385691,0.27441743,0.27497754,0.27553725,0.27609658,
     # 0.27665550,0.27721399,0.27777210,0.27832982,0.27888712,0.27944404,
     # 0.28000057,0.28055671,0.28111246,0.28166780,0.28222278,0.28277737,
     # 0.28333157,0.28388542,0.28443885,0.28499192,0.28554460,0.28609693,
     # 0.28664887,0.28720045,0.28775167,0.28830251,0.28885296,0.28940308,
     # 0.28995281,0.29050222,0.29105124,0.29159990,0.29214820,0.29269618,
     # 0.29324377,0.29379103,0.29433793,0.29488447,0.29543069,0.29597655,
     # 0.29652208,0.29706725,0.29761207,0.29815659,0.29870075,0.29924458,
     # 0.29978806,0.30033123,0.30087405,0.30141655,0.30195874,0.30250058,
     # 0.30304211,0.30358329,0.30412418,0.30466476,0.30520499,0.30574492,
     # 0.30628452,0.30682382,0.30736279,0.30790147,0.30843985,0.30897790,
     # 0.30951566,0.31005311,0.31059024,0.31112710,0.31166363,0.31219989,
     # 0.31273583,0.31327149,0.31380683,0.31434190,0.31487668,0.31541115,
     # 0.31594536,0.31647927,0.31701291,0.31754625,0.31807929,0.31861207,
     # 0.31914458,0.31967679,0.32020873,0.32074040,0.32127178,0.32180291,
     # 0.32233375,0.32286432,0.32339466,0.32392469,0.32445446,0.32498398,
     # 0.32551324,0.32604221,0.32657096,0.32709941,0.32762763,0.32815558,
     # 0.32868329,0.32921073,0.32973793,0.33026487,0.33079156,0.33131802,
     # 0.33184421,0.33237016,0.33289587,0.33342135,0.33394656,0.33447155,
     # 0.33499628,0.33552080,0.33604506,0.33656910,0.33709288,0.33761644,
     # 0.33813980,0.33866289,0.33918577,0.33970842,0.34023082,0.34075302,
     # 0.34127498,0.34179673,0.34231827,0.34283957,0.34336063,0.34388149,
     # 0.34440213,0.34492257,0.34544280,0.34596279,0.34648257,0.34700215,
     # 0.34752151,0.34804067,0.34855962,0.34907836,0.34959689,0.35011524,
     # 0.35063335,0.35115129,0.35166901,0.35218653,0.35270384,0.35322097,
     # 0.35373789,0.35425463,0.35477117,0.35528749,0.35580364,0.35631961,
     # 0.35683537,0.35735095,0.35786635,0.35838154,0.35889655,0.35941139,
     # 0.35992602,0.36044049,0.36095476,0.36146885,0.36198279,0.36249653,
     # 0.36301008,0.36352345,0.36403665,0.36454970,0.36506253,0.36557522,
     # 0.36608773,0.36660007,0.36711225,0.36762422,0.36813605,0.36864772,
     # 0.36915922,0.36967054,0.37018171,0.37069270,0.37120354,0.37171420,
     # 0.37222472,0.37273508,0.37324527,0.37375531,0.37426516,0.37477490,
     # 0.37528446,0.37579387,0.37630311,0.37681222,0.37732115,0.37782997,
     # 0.37833861,0.37884709,0.37935546,0.37986365,0.38037157,0.38087934,
     # 0.38138697,0.38189444,0.38240176,0.38290912,0.38341632,0.38392338,
     # 0.38443032,0.38493720,0.38544393,0.38595054,0.38645700,0.38696334,
     # 0.38746941,0.38797536,0.38848117,0.38898683,0.38949239,0.38999778,
     # 0.39050305,0.39100820,0.39151323,0.39201811,0.39252287/
c
      data tpvel /
     # 0.00399386,0.00416666,0.00438172,0.00462108,0.00486812,0.00511170,
     # 0.00534556,0.00556642,0.00577254,0.00596312,0.00613797,0.00629735,
     # 0.00644187,0.00657234,0.00668977,0.00679521,0.00688971,0.00697431,
     # 0.00704998,0.00711763,0.00717809,0.00723211,0.00728038,0.00732350,
     # 0.00736201,0.00739642,0.00742713,0.00745453,0.00747895,0.00750070,
     # 0.00752003,0.00753717,0.00755234,0.00756572,0.00757747,0.00758773,
     # 0.00759664,0.00760430,0.00761083,0.00761631,0.00762082,0.00762445,
     # 0.00762724,0.00762926,0.00763057,0.00763121,0.00763122,0.00763064,
     # 0.00762951,0.00762785,0.00762571,0.00762310,0.00762004,0.00761657,
     # 0.00761270,0.00760844,0.00760382,0.00759884,0.00759353,0.00758789,
     # 0.00758193,0.00757567,0.00756912,0.00756229,0.00755518,0.00754780,
     # 0.00754017,0.00753228,0.00752414,0.00751576,0.00750715,0.00749831,
     # 0.00748924,0.00747995,0.00747045,0.00746073,0.00745080,0.00744067,
     # 0.00743034,0.00741981,0.00740909,0.00739817,0.00738707,0.00737578,
     # 0.00736430,0.00735264,0.00734081,0.00732879,0.00731660,0.00730424,
     # 0.00729170,0.00727900,0.00726613,0.00725309,0.00723989,0.00722652,
     # 0.00721300,0.00719931,0.00718546,0.00717146,0.00715730,0.00714299,
     # 0.00712852,0.00711390,0.00709913,0.00708421,0.00706914,0.00705392,
     # 0.00703855,0.00702304,0.00700738,0.00699158,0.00697563,0.00695954,
     # 0.00694331,0.00692694,0.00691043,0.00689378,0.00687699,0.00686006,
     # 0.00684299,0.00682579,0.00680845,0.00679098,0.00677337,0.00675563,
     # 0.00673776,0.00671976,0.00670162,0.00668336,0.00666496,0.00664644,
     # 0.00662778,0.00660900,0.00659009,0.00657106,0.00655190,0.00653261,
     # 0.00651320,0.00649367,0.00647401,0.00645424,0.00643433,0.00641432,
     # 0.00639417,0.00637395,0.00635358,0.00633308,0.00631247,0.00629174,
     # 0.00627092,0.00624998,0.00622888,0.00620772,0.00618640,0.00616498,
     # 0.00614347,0.00612183,0.00610009,0.00607825,0.00605627,0.00603422,
     # 0.00601204,0.00598976,0.00596740,0.00594492,0.00592236,0.00589970,
     # 0.00587695,0.00585410,0.00583115,0.00580812,0.00578499,0.00576177,
     # 0.00573847,0.00571508,0.00569160,0.00566804,0.00564440,0.00562067,
     # 0.00559687,0.00557299,0.00554903,0.00552500,0.00550090,0.00547673,
     # 0.00545249,0.00542818,0.00540381,0.00537938,0.00535488,0.00533033,
     # 0.00530572,0.00528106,0.00525634,0.00523157,0.00520676,0.00518190,
     # 0.00515699,0.00513205,0.00510707,0.00508205,0.00505699,0.00503191,
     # 0.00500679,0.00498165,0.00495648,0.00493129,0.00490609,0.00488086,
     # 0.00485562,0.00483037,0.00480512,0.00477985,0.00475458,0.00472931,
     # 0.00470404,0.00467878,0.00465353,0.00462828,0.00460305,0.00457784,
     # 0.00455264,0.00452747,0.00450232,0.00447719,0.00445210,0.00442704,
     # 0.00440202,0.00437704,0.00435210,0.00432720,0.00430235,0.00427755,
     # 0.00425280,0.00422811,0.00420347,0.00417890,0.00415439,0.00412995,
     # 0.00410558,0.00408128,0.00405706,0.00403291,0.00400885,0.00398486,
     # 0.00396097,0.00393716,0.00391344,0.00388982,0.00386629,0.00384286,
     # 0.00381953,0.00379631,0.00377319,0.00375017,0.00372727,0.00370448,
     # 0.00368181,0.00365925,0.00363681,0.00361449,0.00359230,0.00357023,
     # 0.00354829,0.00352647,0.00350479,0.00348324,0.00346182,0.00344054,
     # 0.00341940,0.00339840,0.00337753,0.00335681,0.00333623,0.00331580,
     # 0.00329551,0.00327538,0.00325538,0.00323554,0.00321585,0.00319632,
     # 0.00317693,0.00315770,0.00313863,0.00311971,0.00310094,0.00308234,
     # 0.00306389,0.00304560,0.00302747,0.00300950,0.00299168,0.00297403,
     # 0.00295654,0.00293921,0.00292205,0.00290504,0.00288819,0.00287151,
     # 0.00285499,0.00283863,0.00282244,0.00280640,0.00279053,0.00277482,
     # 0.00275927,0.00274388,0.00272865,0.00271358,0.00269868,0.00268393,
     # 0.00266934,0.00265491,0.00264064,0.00262653,0.00261258,0.00259878,
     # 0.00258514,0.00257165,0.00255832,0.00254514,0.00253212,0.00251925,
     # 0.00250653,0.00249396,0.00248155,0.00246928,0.00245716,0.00244519,
     # 0.00243336,0.00242168,0.00241014,0.00239875,0.00238750,0.00237640,
     # 0.00236543,0.00235460,0.00234392,0.00233337,0.00232295,0.00231267,
     # 0.00230253,0.00229252,0.00228264,0.00227289,0.00226327,0.00225378,
     # 0.00224442,0.00223518,0.00222607,0.00221708,0.00220822,0.00219948,
     # 0.00219085,0.00218235,0.00217396,0.00216569,0.00215754,0.00214950,
     # 0.00214158,0.00213376,0.00212606,0.00211847,0.00211098,0.00210361,
     # 0.00209634,0.00208917,0.00208211,0.00207515,0.00206829,0.00206153,
     # 0.00205487,0.00204831,0.00204185,0.00203548,0.00202920,0.00202302,
     # 0.00201693,0.00201093,0.00200503,0.00199921,0.00199348,0.00198783,
     # 0.00198228,0.00197680,0.00197141,0.00196610,0.00196088,0.00195573,
     # 0.00195066,0.00194567,0.00194076,0.00193592,0.00193116,0.00192648,
     # 0.00192186,0.00191732,0.00191285,0.00190845,0.00190412,0.00189986,
     # 0.00189567,0.00189154,0.00188748,0.00188348,0.00187954,0.00187567,
     # 0.00187186,0.00186812,0.00186443,0.00186080,0.00185723,0.00185372,
     # 0.00185026,0.00184687,0.00184352,0.00184023,0.00183700,0.00183381,
     # 0.00183068,0.00182760,0.00182458,0.00182160,0.00181867,0.00181579,
     # 0.00181295,0.00181017,0.00180743,0.00180473,0.00180208,0.00179948,
     # 0.00179692,0.00179440,0.00179192,0.00178948,0.00178709,0.00178474,
     # 0.00178242,0.00178015,0.00177791,0.00177571,0.00177355,0.00177143,
     # 0.00176934,0.00176729,0.00176527,0.00176329,0.00176134,0.00175942,
     # 0.00175754,0.00175569,0.00175387,0.00175209,0.00175033,0.00174861,
     # 0.00174691,0.00174524,0.00174361,0.00174200,0.00174042,0.00173887,
     # 0.00173734,0.00173584,0.00173437,0.00173292,0.00173150,0.00173011,
     # 0.00172873,0.00172739,0.00172606,0.00172476,0.00172349,0.00172223,
     # 0.00172100,0.00171979,0.00171860,0.00171744,0.00171629,0.00171517,
     # 0.00171406,0.00171298,0.00171191,0.00171086,0.00170984,0.00170883,
     # 0.00170784,0.00170686,0.00170591,0.00170497,0.00170405,0.00170315,
     # 0.00170226,0.00170139,0.00170054,0.00169970,0.00169887,0.00169806,
     # 0.00169727,0.00169649,0.00169573,0.00169498,0.00169424,0.00169352,
     # 0.00169281,0.00169211,0.00169143,0.00169076,0.00169010,0.00168946,
     # 0.00168883,0.00168821,0.00168760,0.00168700,0.00168641,0.00168584,
     # 0.00168527,0.00168472,0.00168418,0.00168364,0.00168312,0.00168261,
     # 0.00168211,0.00168161,0.00168113,0.00168066,0.00168019,0.00167974,
     # 0.00167929,0.00167885,0.00167842,0.00167800,0.00167759,0.00167719,
     # 0.00167679,0.00167640,0.00167602,0.00167565,0.00167528,0.00167492,
     # 0.00167457,0.00167422,0.00167389,0.00167356,0.00167323,0.00167291,
     # 0.00167260,0.00167230,0.00167200,0.00167171,0.00167142,0.00167114,
     # 0.00167087,0.00167060,0.00167033,0.00167007,0.00166982,0.00166957,
     # 0.00166933,0.00166909,0.00166886,0.00166864,0.00166841,0.00166819,
     # 0.00166798,0.00166777,0.00166757,0.00166737,0.00166717,0.00166698,
     # 0.00166680,0.00166661,0.00166643,0.00166626,0.00166609,0.00166592,
     # 0.00166576,0.00166560,0.00166544,0.00166529,0.00166514,0.00166499,
     # 0.00166485,0.00166471,0.00166458,0.00166444,0.00166431,0.00166419,
     # 0.00166406,0.00166394,0.00166382,0.00166371,0.00166359,0.00166348,
     # 0.00166338,0.00166327,0.00166317,0.00166307,0.00166297,0.00166288,
     # 0.00166279,0.00166270,0.00166261,0.00166252,0.00166244,0.00166236,
     # 0.00166228,0.00166220,0.00166213,0.00166206,0.00166199,0.00166192,
     # 0.00166185,0.00166178,0.00166172,0.00166166,0.00166160,0.00166154,
     # 0.00166149,0.00166143,0.00166138,0.00166133,0.00166128,0.00166123,
     # 0.00166118,0.00166114,0.00166109,0.00166105,0.00166100,0.00166096,
     # 0.00166092,0.00166089,0.00166085,0.00166082,0.00166078,0.00166075,
     # 0.00166072,0.00166069,0.00166066,0.00166063,0.00166060/
c
      data somega /
     # 0.00194327,0.00294407,0.00406573,0.00528063,0.00652341,0.00773970,
     # 0.00888144,0.00991674,0.01084782,0.01170198,0.01250596,0.01327604,
     # 0.01402037,0.01474283,0.01544548,0.01612975,0.01679691,0.01744832,
     # 0.01808540,0.01870965,0.01932258,0.01992564,0.02052024,0.02110765,
     # 0.02168906,0.02226550,0.02283790,0.02340707,0.02397371,0.02453840,
     # 0.02510166,0.02566391,0.02622550,0.02678673,0.02734784,0.02790903,
     # 0.02847045,0.02903225,0.02959453,0.03015735,0.03072079,0.03128488,
     # 0.03184966,0.03241515,0.03298136,0.03354830,0.03411597,0.03468436,
     # 0.03525347,0.03582329,0.03639381,0.03696500,0.03753686,0.03810938,
     # 0.03868253,0.03925630,0.03983068,0.04040565,0.04098120,0.04155730,
     # 0.04213395,0.04271113,0.04328883,0.04386703,0.04444573,0.04502491,
     # 0.04560457,0.04618468,0.04676525,0.04734625,0.04792769,0.04850956,
     # 0.04909183,0.04967453,0.05025762,0.05084110,0.05142498,0.05200923,
     # 0.05259386,0.05317887,0.05376424,0.05434996,0.05493604,0.05552248,
     # 0.05610926,0.05669638,0.05728384,0.05787164,0.05845976,0.05904821,
     # 0.05963698,0.06022607,0.06081548,0.06140519,0.06199522,0.06258555,
     # 0.06317618,0.06376711,0.06435833,0.06494985,0.06554165,0.06613375,
     # 0.06672611,0.06731876,0.06791168,0.06850488,0.06909835,0.06969208,
     # 0.07028607,0.07088032,0.07147484,0.07206959,0.07266460,0.07325986,
     # 0.07385536,0.07445109,0.07504706,0.07564326,0.07623969,0.07683635,
     # 0.07743323,0.07803032,0.07862763,0.07922515,0.07982288,0.08042081,
     # 0.08101894,0.08161727,0.08221579,0.08281449,0.08341339,0.08401247,
     # 0.08461173,0.08521116,0.08581076,0.08641053,0.08701047,0.08761057,
     # 0.08821081,0.08881123,0.08941178,0.09001248,0.09061333,0.09121431,
     # 0.09181543,0.09241669,0.09301807,0.09361958,0.09422120,0.09482295,
     # 0.09542482,0.09602679,0.09662887,0.09723106,0.09783335,0.09843574,
     # 0.09903822,0.09964079,0.10024345,0.10084620,0.10144903,0.10205194,
     # 0.10265492,0.10325797,0.10386109,0.10446429,0.10506754,0.10567085,
     # 0.10627422,0.10687765,0.10748113,0.10808466,0.10868822,0.10929184,
     # 0.10989549,0.11049918,0.11110290,0.11170666,0.11231044,0.11291425,
     # 0.11351808,0.11412194,0.11472581,0.11532969,0.11593359,0.11653750,
     # 0.11714142,0.11774534,0.11834926,0.11895319,0.11955711,0.12016103,
     # 0.12076494,0.12136885,0.12197273,0.12257661,0.12318047,0.12378432,
     # 0.12438814,0.12499194,0.12559570,0.12619945,0.12680317,0.12740687,
     # 0.12801051,0.12861413,0.12921771,0.12982126,0.13042475,0.13102821,
     # 0.13163161,0.13223498,0.13283828,0.13344154,0.13404475,0.13464791,
     # 0.13525100,0.13585404,0.13645701,0.13705993,0.13766277,0.13826555,
     # 0.13886827,0.13947092,0.14007349,0.14067599,0.14127842,0.14188077,
     # 0.14248304,0.14308523,0.14368734,0.14428937,0.14489131,0.14549316,
     # 0.14609493,0.14669661,0.14729820,0.14789970,0.14850111,0.14910242,
     # 0.14970362,0.15030473,0.15090574,0.15150666,0.15210746,0.15270817,
     # 0.15330876,0.15390925,0.15450963,0.15510990,0.15571006,0.15631010,
     # 0.15691003,0.15750985,0.15810955,0.15870912,0.15930858,0.15990791,
     # 0.16050713,0.16110621,0.16170518,0.16230401,0.16290273,0.16350131,
     # 0.16409975,0.16469806,0.16529626,0.16589430,0.16649221,0.16708998,
     # 0.16768761,0.16828512,0.16888246,0.16947967,0.17007674,0.17067367,
     # 0.17127044,0.17186707,0.17246355,0.17305988,0.17365605,0.17425208,
     # 0.17484795,0.17544366,0.17603922,0.17663462,0.17722987,0.17782494,
     # 0.17841986,0.17901462,0.17960921,0.18020365,0.18079790,0.18139200,
     # 0.18198593,0.18257968,0.18317327,0.18376668,0.18435992,0.18495299,
     # 0.18554588,0.18613859,0.18673111,0.18732348,0.18791565,0.18850763,
     # 0.18909945,0.18969107,0.19028251,0.19087376,0.19146483,0.19205569,
     # 0.19264637,0.19323687,0.19382717,0.19441727,0.19500718,0.19559689,
     # 0.19618641,0.19677573,0.19736485,0.19795376,0.19854248,0.19913098,
     # 0.19971929,0.20030740,0.20089529,0.20148297,0.20207044,0.20265771,
     # 0.20324476,0.20383161,0.20441823,0.20500465,0.20559084,0.20617682,
     # 0.20676258,0.20734811,0.20793343,0.20851852,0.20910339,0.20968804,
     # 0.21027246,0.21085666,0.21144062,0.21202436,0.21260786,0.21319114,
     # 0.21377417,0.21435697,0.21493955,0.21552187,0.21610397,0.21668583,
     # 0.21726744,0.21784882,0.21842995,0.21901083,0.21959148,0.22017187,
     # 0.22075202,0.22133192,0.22191158,0.22249097,0.22307011,0.22364901,
     # 0.22422765,0.22480604,0.22538416,0.22596203,0.22653964,0.22711699,
     # 0.22769408,0.22827090,0.22884746,0.22942375,0.22999978,0.23057553,
     # 0.23115103,0.23172624,0.23230121,0.23287587,0.23345028,0.23402441,
     # 0.23459826,0.23517184,0.23574513,0.23631814,0.23689088,0.23746334,
     # 0.23803550,0.23860739,0.23917899,0.23975030,0.24032132,0.24089207,
     # 0.24146250,0.24203266,0.24260251,0.24317208,0.24374135,0.24431032,
     # 0.24487899,0.24544737,0.24601544,0.24658322,0.24715069,0.24771787,
     # 0.24828473,0.24885128,0.24941754,0.24998349,0.25054911,0.25111443,
     # 0.25167945,0.25224414,0.25280854,0.25337261,0.25393635,0.25449979,
     # 0.25506291,0.25562569,0.25618815,0.25675032,0.25731215,0.25787362,
     # 0.25843480,0.25899565,0.25955617,0.26011637,0.26067623,0.26123574,
     # 0.26179495,0.26235381,0.26291233,0.26347050,0.26402837,0.26458588,
     # 0.26514304,0.26569986,0.26625636,0.26681250,0.26736829,0.26792374,
     # 0.26847884,0.26903361,0.26958802,0.27014208,0.27069578,0.27124912,
     # 0.27180213,0.27235475,0.27290705,0.27345899,0.27401054,0.27456176,
     # 0.27511263,0.27566311,0.27621323,0.27676299,0.27731240,0.27786142,
     # 0.27841008,0.27895838,0.27950633,0.28005388,0.28060105,0.28114787,
     # 0.28169429,0.28224036,0.28278604,0.28333136,0.28387630,0.28442085,
     # 0.28496504,0.28550881,0.28605223,0.28659526,0.28713790,0.28768015,
     # 0.28822201,0.28876352,0.28930461,0.28984532,0.29038563,0.29092556,
     # 0.29146507,0.29200423,0.29254296,0.29308131,0.29361928,0.29415682,
     # 0.29469398,0.29523075,0.29576710,0.29630306,0.29683861,0.29737374,
     # 0.29790848,0.29844284,0.29897678,0.29951030,0.30004343,0.30057612,
     # 0.30110845,0.30164033,0.30217180,0.30270287,0.30323353,0.30376378,
     # 0.30429360,0.30482301,0.30535200,0.30588058,0.30640873,0.30693647,
     # 0.30746377,0.30799067,0.30851713,0.30904320,0.30956882,0.31009403,
     # 0.31061879,0.31114316,0.31166708,0.31219056,0.31271365,0.31323627,
     # 0.31375849,0.31428027,0.31480160,0.31532252,0.31584302,0.31636307,
     # 0.31688267,0.31740186,0.31792060,0.31843892,0.31895679,0.31947422,
     # 0.31999120,0.32050776,0.32102388,0.32153955,0.32205477,0.32256958,
     # 0.32308391,0.32359782,0.32411128,0.32462430,0.32513687,0.32564899,
     # 0.32616070,0.32667193,0.32718271,0.32769305,0.32820293,0.32871237,
     # 0.32922137,0.32972991,0.33023801,0.33074567,0.33125284,0.33175957,
     # 0.33226585,0.33277169,0.33327708,0.33378202,0.33428648,0.33479050,
     # 0.33529404,0.33579716,0.33629981,0.33680201,0.33730373,0.33780500,
     # 0.33830583,0.33880618,0.33930609,0.33980554,0.34030452,0.34080303,
     # 0.34130108,0.34179869,0.34229583,0.34279251,0.34328875,0.34378448,
     # 0.34427980,0.34477463,0.34526899,0.34576291,0.34625635,0.34674934,
     # 0.34724188,0.34773391,0.34822550,0.34871665,0.34920731,0.34969750,
     # 0.35018724,0.35067654,0.35116532,0.35165367,0.35214156,0.35262895,
     # 0.35311592,0.35360238,0.35408840,0.35457397,0.35505903,0.35554364,
     # 0.35602781,0.35651150,0.35699472,0.35747746,0.35795975,0.35844156,
     # 0.35892293,0.35940382,0.35988423,0.36036420,0.36084369,0.36132273,
     # 0.36180127,0.36227936,0.36275700,0.36323416,0.36371085,0.36418709,
     # 0.36466286,0.36513814,0.36561298,0.36608735,0.36656123,0.36703467,
     # 0.36750764,0.36798015,0.36845219,0.36892378,0.36939490,0.36986554,
     # 0.37033573,0.37080544,0.37127471,0.37174350,0.37221184,0.37267971,
     # 0.37314710,0.37361404,0.37408054,0.37454656,0.37501213,0.37547722,
     # 0.37594184,0.37640601,0.37686974,0.37733302,0.37779579,0.37825814,
     # 0.37872002,0.37918144,0.37964240,0.38010290,0.38056293,0.38102254,
     # 0.38148165,0.38194034,0.38239855,0.38285631,0.38331363,0.38377050,
     # 0.38422689,0.38468283,0.38513833,0.38559335,0.38604796,0.38650209,
     # 0.38695577,0.38740900,0.38786179,0.38831404,0.38876596,0.38921741,
     # 0.38966838,0.39011893,0.39056900,0.39101866,0.39146784,0.39191660,
     # 0.39236489/
c
      data spvel /
     # 0.00196222,0.00239527,0.00267957,0.00281230,0.00287890,0.00292350,
     # 0.00296390,0.00300516,0.00305051,0.00310516,0.00317296,0.00325538,
     # 0.00335248,0.00346336,0.00358643,0.00371953,0.00386020,0.00400588,
     # 0.00415411,0.00430270,0.00444982,0.00459400,0.00473419,0.00486963,
     # 0.00499988,0.00512472,0.00524414,0.00535824,0.00546721,0.00557131,
     # 0.00567085,0.00576615,0.00585752,0.00594528,0.00602972,0.00611113,
     # 0.00618977,0.00626587,0.00633966,0.00641131,0.00648100,0.00654888,
     # 0.00661508,0.00667971,0.00674288,0.00680466,0.00686512,0.00692432,
     # 0.00698231,0.00703913,0.00709481,0.00714937,0.00720283,0.00725521,
     # 0.00730650,0.00735673,0.00740588,0.00745397,0.00750098,0.00754691,
     # 0.00759177,0.00763554,0.00767821,0.00771979,0.00776026,0.00779962,
     # 0.00783786,0.00787498,0.00791098,0.00794584,0.00797957,0.00801217,
     # 0.00804362,0.00807394,0.00810312,0.00813115,0.00815806,0.00818383,
     # 0.00820847,0.00823198,0.00825437,0.00827565,0.00829583,0.00831490,
     # 0.00833288,0.00834977,0.00836560,0.00838036,0.00839406,0.00840673,
     # 0.00841837,0.00842898,0.00843860,0.00844722,0.00845486,0.00846154,
     # 0.00846726,0.00847205,0.00847592,0.00847888,0.00848094,0.00848213,
     # 0.00848245,0.00848193,0.00848057,0.00847839,0.00847541,0.00847165,
     # 0.00846711,0.00846182,0.00845578,0.00844902,0.00844155,0.00843338,
     # 0.00842453,0.00841502,0.00840485,0.00839405,0.00838262,0.00837058,
     # 0.00835796,0.00834475,0.00833097,0.00831664,0.00830178,0.00828638,
     # 0.00827048,0.00825407,0.00823718,0.00821982,0.00820199,0.00818371,
     # 0.00816500,0.00814586,0.00812630,0.00810634,0.00808599,0.00806526,
     # 0.00804416,0.00802271,0.00800090,0.00797875,0.00795628,0.00793349,
     # 0.00791039,0.00788700,0.00786331,0.00783934,0.00781510,0.00779060,
     # 0.00776585,0.00774085,0.00771562,0.00769015,0.00766447,0.00763858,
     # 0.00761247,0.00758618,0.00755969,0.00753302,0.00750617,0.00747916,
     # 0.00745199,0.00742466,0.00739718,0.00736956,0.00734181,0.00731392,
     # 0.00728592,0.00725779,0.00722956,0.00720122,0.00717278,0.00714424,
     # 0.00711562,0.00708691,0.00705813,0.00702927,0.00700034,0.00697134,
     # 0.00694229,0.00691318,0.00688402,0.00685482,0.00682558,0.00679629,
     # 0.00676698,0.00673763,0.00670827,0.00667888,0.00664947,0.00662005,
     # 0.00659062,0.00656118,0.00653174,0.00650230,0.00647287,0.00644344,
     # 0.00641403,0.00638462,0.00635524,0.00632587,0.00629652,0.00626721,
     # 0.00623792,0.00620866,0.00617943,0.00615025,0.00612110,0.00609199,
     # 0.00606293,0.00603391,0.00600494,0.00597602,0.00594716,0.00591835,
     # 0.00588960,0.00586091,0.00583228,0.00580372,0.00577522,0.00574679,
     # 0.00571842,0.00569013,0.00566192,0.00563377,0.00560571,0.00557772,
     # 0.00554981,0.00552198,0.00549423,0.00546657,0.00543900,0.00541151,
     # 0.00538411,0.00535680,0.00532957,0.00530245,0.00527541,0.00524847,
     # 0.00522163,0.00519488,0.00516823,0.00514168,0.00511523,0.00508888,
     # 0.00506263,0.00503648,0.00501044,0.00498450,0.00495867,0.00493295,
     # 0.00490733,0.00488182,0.00485641,0.00483112,0.00480593,0.00478086,
     # 0.00475590,0.00473105,0.00470631,0.00468168,0.00465717,0.00463277,
     # 0.00460848,0.00458431,0.00456026,0.00453632,0.00451250,0.00448879,
     # 0.00446520,0.00444172,0.00441837,0.00439513,0.00437201,0.00434901,
     # 0.00432612,0.00430336,0.00428071,0.00425819,0.00423578,0.00421349,
     # 0.00419132,0.00416927,0.00414734,0.00412553,0.00410384,0.00408227,
     # 0.00406082,0.00403949,0.00401828,0.00399719,0.00397623,0.00395538,
     # 0.00393465,0.00391404,0.00389355,0.00387318,0.00385293,0.00383280,
     # 0.00381279,0.00379290,0.00377313,0.00375348,0.00373395,0.00371454,
     # 0.00369524,0.00367607,0.00365701,0.00363807,0.00361925,0.00360055,
     # 0.00358196,0.00356350,0.00354514,0.00352691,0.00350879,0.00349079,
     # 0.00347291,0.00345514,0.00343749,0.00341995,0.00340253,0.00338522,
     # 0.00336803,0.00335095,0.00333398,0.00331713,0.00330039,0.00328377,
     # 0.00326725,0.00325085,0.00323456,0.00321838,0.00320232,0.00318636,
     # 0.00317051,0.00315478,0.00313915,0.00312363,0.00310822,0.00309292,
     # 0.00307773,0.00306264,0.00304767,0.00303280,0.00301803,0.00300337,
     # 0.00298882,0.00297437,0.00296002,0.00294578,0.00293165,0.00291761,
     # 0.00290368,0.00288986,0.00287613,0.00286250,0.00284898,0.00283556,
     # 0.00282224,0.00280901,0.00279589,0.00278286,0.00276994,0.00275711,
     # 0.00274438,0.00273174,0.00271920,0.00270676,0.00269441,0.00268216,
     # 0.00267001,0.00265794,0.00264597,0.00263410,0.00262231,0.00261062,
     # 0.00259902,0.00258751,0.00257609,0.00256477,0.00255353,0.00254238,
     # 0.00253132,0.00252035,0.00250946,0.00249867,0.00248796,0.00247733,
     # 0.00246680,0.00245634,0.00244598,0.00243569,0.00242549,0.00241538,
     # 0.00240535,0.00239540,0.00238553,0.00237574,0.00236604,0.00235641,
     # 0.00234687,0.00233740,0.00232801,0.00231871,0.00230948,0.00230033,
     # 0.00229125,0.00228225,0.00227333,0.00226449,0.00225572,0.00224702,
     # 0.00223840,0.00222985,0.00222138,0.00221298,0.00220465,0.00219639,
     # 0.00218821,0.00218009,0.00217205,0.00216408,0.00215617,0.00214834,
     # 0.00214057,0.00213288,0.00212525,0.00211768,0.00211019,0.00210276,
     # 0.00209540,0.00208810,0.00208087,0.00207370,0.00206660,0.00205956,
     # 0.00205258,0.00204567,0.00203882,0.00203203,0.00202530,0.00201864,
     # 0.00201203,0.00200548,0.00199900,0.00199257,0.00198621,0.00197990,
     # 0.00197365,0.00196745,0.00196132,0.00195524,0.00194922,0.00194325,
     # 0.00193734,0.00193149,0.00192569,0.00191994,0.00191425,0.00190861,
     # 0.00190302,0.00189749,0.00189201,0.00188658,0.00188120,0.00187588,
     # 0.00187060,0.00186538,0.00186020,0.00185507,0.00185000,0.00184497,
     # 0.00183999,0.00183506,0.00183018,0.00182534,0.00182055,0.00181581,
     # 0.00181111,0.00180646,0.00180185,0.00179729,0.00179278,0.00178830,
     # 0.00178388,0.00177949,0.00177515,0.00177085,0.00176660,0.00176238,
     # 0.00175821,0.00175408,0.00174999,0.00174594,0.00174194,0.00173797,
     # 0.00173404,0.00173015,0.00172630,0.00172249,0.00171872,0.00171498,
     # 0.00171128,0.00170762,0.00170400,0.00170042,0.00169687,0.00169335,
     # 0.00168988,0.00168643,0.00168303,0.00167966,0.00167632,0.00167301,
     # 0.00166975,0.00166651,0.00166331,0.00166014,0.00165700,0.00165390,
     # 0.00165083,0.00164779,0.00164478,0.00164180,0.00163885,0.00163594,
     # 0.00163305,0.00163020,0.00162737,0.00162458,0.00162181,0.00161907,
     # 0.00161636,0.00161368,0.00161103,0.00160841,0.00160581,0.00160324,
     # 0.00160070,0.00159819,0.00159570,0.00159324,0.00159080,0.00158839,
     # 0.00158601,0.00158365,0.00158131,0.00157900,0.00157672,0.00157446,
     # 0.00157222,0.00157001,0.00156782,0.00156566,0.00156352,0.00156140,
     # 0.00155930,0.00155723,0.00155518,0.00155315,0.00155114,0.00154916,
     # 0.00154719,0.00154525,0.00154333,0.00154143,0.00153954,0.00153768,
     # 0.00153584,0.00153402,0.00153222,0.00153044,0.00152868,0.00152694,
     # 0.00152521,0.00152351,0.00152182,0.00152015,0.00151850,0.00151687,
     # 0.00151525,0.00151366,0.00151208,0.00151051,0.00150897,0.00150744,
     # 0.00150592,0.00150443,0.00150295,0.00150148,0.00150004,0.00149860,
     # 0.00149719,0.00149579,0.00149440,0.00149303,0.00149167,0.00149033,
     # 0.00148900,0.00148769,0.00148639,0.00148511,0.00148384,0.00148258,
     # 0.00148134,0.00148011,0.00147889,0.00147769,0.00147650,0.00147532,
     # 0.00147415,0.00147300,0.00147186,0.00147073,0.00146962,0.00146852,
     # 0.00146742,0.00146634,0.00146527,0.00146422,0.00146317,0.00146214,
     # 0.00146111,0.00146010,0.00145910,0.00145811,0.00145712,0.00145615,
     # 0.00145519,0.00145424,0.00145330,0.00145237,0.00145145,0.00145054,
     # 0.00144964,0.00144875,0.00144786,0.00144699,0.00144613,0.00144527,
     # 0.00144442,0.00144359,0.00144276,0.00144194,0.00144112,0.00144032,
     # 0.00143952,0.00143874,0.00143796,0.00143718,0.00143642,0.00143566,
     # 0.00143492,0.00143417,0.00143344,0.00143271,0.00143199,0.00143128,
     # 0.00143058,0.00142988,0.00142919,0.00142850,0.00142783,0.00142715,
     # 0.00142649,0.00142583,0.00142518,0.00142453,0.00142389,0.00142326,
     # 0.00142263,0.00142201,0.00142140,0.00142079,0.00142018,0.00141958,
     # 0.00141899,0.00141840,0.00141782,0.00141725,0.00141667,0.00141611,
     # 0.00141555,0.00141499,0.00141444,0.00141389,0.00141335,0.00141282,
     # 0.00141228/
c
      if(.not.splined) then
        if(iprtlv.gt.1) then
        write(6,"('there are ',i5,' toroidal modes in spline')") ntspl
        write(6,"('there are ',i5,' spheroidal modes in spline')") nsspl
        endif
        call rspln(1,ntspl,tomega,tpvel,tcube,work)
        call rspln(1,nsspl,somega,spvel,scube,work)
        splined=.true.
      endif
c
      if(modetype.eq.1) then
        pvel=rsple(1,ntspl,tomega,tpvel,tcube,omega)
      else
        pvel=rsple(1,nsspl,somega,spvel,scube,omega)
      endif
      premgesmallq=pvel
      return
      end
